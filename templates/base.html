<!doctype html>
<html lang="{{ lang }}">
    <head>
        <meta charset="UTF-8">
        <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
        <meta content="text/html; charset=UTF-8" http-equiv="content-type"/>
        <meta content="width=device-width, initial-scale=1" name="viewport"/>

        {% if page.title %}
        {% set title = page.title %}
        {% elif section.title %}
        {% set title = section.title %}
        {% elif config.title %}
        {% set title = config.title %}
        {% endif %}

        {% if page.extra.author %}
        {% set author = page.extra.author %}
        {% elif section.extra.author %}
        {% set author = section.extra.author %}
        {% elif config.extra.author %}
        {% set author = config.extra.author %}
        {% endif %}

        {% if page.description %}
        {% set description = page.description | truncate(length=150) %}
        {% elif section.description %}
        {% set description = section.description | truncate(length=150) %}
        {% elif config.description %}
        {% set description = config.description | truncate(length=150) %}
        {% endif %}

        {% if page.extra.image %}
        {% set image = get_url(path=page.extra.image, trailing_slash=false) %}
        {% elif section.extra.image %}
        {% set image = get_url(path=section.extra.image, trailing_slash=false) %}
        {% elif config.extra.logo %}
        {% set image = get_url(path=config.extra.logo, trailing_slash=false) %}
        {% endif %}

        {% if page.permalink %}
        {% set url = page.permalink %}
        {% elif section.permalink %}
        {% set url = section.permalink %}
        {% elif config.base_url %}
        {% set url = config.base_url %}
        {% endif %}

        {% if title %}<title>{{ title }}</title>{% endif %}
        {% block metatags %}
        {% if title %}<meta name="title" content="{{ title }}">{% endif %}
        {% if author %}<meta name="author" content="{{ author }}">{% endif %}
        {% if description %}<meta name="description" content="{{ description }}">{% endif %}
        <meta name="generator" content="Zola v0.16.1">

        <meta property="og:type" content="website">
        <meta property="og:url" content="{{ url | safe }}">
        {% if title %}<meta property="og:site_name" content="{{ config.title }}">{% endif %}
        {% if title %}<meta property="og:title" content="{{ title }}">{% endif %}
        {% if description %}<meta property="og:description" content="{{ description }}">{% endif %}
        {% if image %}<meta property="og:image" content="{{ image }}">{% endif %}

        {% set twitter_card = config.extra.twitter_card | default(value=true) %}
        {% if twitter_card != false %}
        <meta property="twitter:card" content="summary_large_image">
        <meta property="twitter:url" content="{{ url | safe }}">
        {% if title %}<meta property="twitter:title" content="{{ title }}">{% endif %}
        {% if description %}<meta property="twitter:description" content="{{ description }}">{% endif %}
        {% if image %}<meta property="twitter:image" content="{{ image }}">{% endif %}
        {% endif %}
        
        <link rel="canonical" href="{{ url | safe }}">
        {% if image %}<link rel="shortcut icon" type="image/x-icon" href="{{ get_url(path=config.extra.logo, trailing_slash=false) }}">{% endif %}
        <script type="application/ld+json">
            {
                {% if description %}"description":"{{ description | safe }}",{% endif %}
                "url":"{{ url | safe }}",
                "@type":"WebSite",
                {% if title %}"headline":"{{ title | safe }}",{% endif %}
                {% if title %}"name":"{{ title | safe }}",{% endif %}
                {% if author %}"author":{
                    "@type":"Person",
                    "name":"{{ author | safe }}"
                },{% endif %}
                "@context":"https://schema.org"
            }
        </script>
        {% endblock metatags %}
        {% if config.generate_feeds %}
        {% block feed %}
        <link rel="alternate" type="application/rss+xml" title="RSS" href="{{ get_url(path="rss.xml", trailing_slash=false) }}">
        {% endblock feed %}
        {% endif %}
        {% block css %}
        <link rel="stylesheet" href="{{ get_url(path='style.css', trailing_slash=false) | safe }}"/>
        {% endblock css %}
    </head>
    <body theme="auto">
        <div id="cursor"></div>
        <script>
            const cursor = document.getElementById('cursor');
            document.addEventListener('mousemove', e => {
                cursor.style.left = e.clientX + 'px';
                cursor.style.top = e.clientY + 'px';
            });
        </script>
        <div class="w">
            <header>
                {% if config.extra.header_nav %}
                <nav>
                    {% for nav_item in config.extra.header_nav %}
                    <a href="{{ nav_item.url | safe }}" {% if nav_item.new_tab %}target="_blank" rel="noreferrer noopener"{% endif %}>{{ nav_item.name }}</a>
                    {% endfor %}
                </nav>
                {% endif %}
                {% block header %}
                {% if title %}
                <h1 class="site-title">{{ config.title }}</h1>
                {% endif %}
                {% endblock header %}
            </header>
            <main class="page-content" aria-label="Content">
                {% block content %}{% endblock content %}
            </main>
            <footer>
                {% block footer %}{% endblock footer %}
                {% if config.extra.footer_nav %}
                <nav>
                    {% for nav_item in config.extra.footer_nav %}
                    <a href="{{ nav_item.url | safe }}">{{ nav_item.name }}</a>
                    {% endfor %}
                </nav>
                {% endif %}
            </footer>
        </div>
        <script>
            document.addEventListener('click', function(e) {
                if (e.target.closest('a')) return;
                dropSeed(e.clientX, e.clientY);
            });

            function dropSeed(x, y) {
                const seed = document.createElement('div');
                seed.className = 'garden-seed';
                seed.style.left = x + 'px';
                seed.style.top = y + 'px';
                document.body.appendChild(seed);

                const targetY = window.innerHeight - 35;
                const duration = 500 + Math.random() * 400;

                seed.animate(
                    [{ top: y + 'px' }, { top: targetY + 'px' }],
                    { duration, easing: 'cubic-bezier(0.33, 0, 0.66, 1)', fill: 'forwards' }
                ).onfinish = () => {
                    seed.remove();
                    bloomFlower(x);
                };
            }

            function bloomFlower(x) {
                const colors = ['#e8a0b0', '#d4b8d8', '#f0c080', '#a8c8a8', '#b8d4f0'];
                const c = colors[Math.floor(Math.random() * colors.length)];
                const el = document.createElement('div');
                el.className = 'garden-flower';
                el.style.left = x + 'px';
                el.innerHTML = `<svg viewBox="-25 -65 50 70" width="50" height="70" xmlns="http://www.w3.org/2000/svg">
                    <line class="f-stem" x1="0" y1="4" x2="0" y2="-28" stroke="#445539" stroke-width="2.5" stroke-linecap="round"/>
                    <ellipse class="f-leaf" cx="-10" cy="-14" rx="9" ry="4" fill="#4a6640" transform="rotate(-40,-10,-14)" opacity="0"/>
                    <g class="f-bloom">
                        <circle cx="0" cy="-44" r="7" fill="${c}"/>
                        <circle cx="0" cy="-30" r="7" fill="${c}"/>
                        <circle cx="-12" cy="-37" r="7" fill="${c}"/>
                        <circle cx="12" cy="-37" r="7" fill="${c}"/>
                        <circle cx="0" cy="-37" r="6" fill="#f0c060"/>
                    </g>
                </svg>`;
                document.body.appendChild(el);

                setTimeout(() => {
                    el.style.transition = 'opacity 1.5s ease';
                    el.style.opacity = '0';
                    setTimeout(() => el.remove(), 1500);
                }, 7000);
            }
        </script>
    </body>
</html>
        
